!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.io=e()}}(function(){var e;return function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){function r(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=o(e),i=r.source,c=r.id,l=r.path,h=u[c]&&l in u[c].nsps,f=t.forceNew||t["force new connection"]||!1===t.multiplex||h;return f?(a("ignoring socket cache for %s",i),n=s(i,t)):(u[c]||(a("new io instance for %s",i),u[c]=s(i,t)),n=u[c]),n.socket(r.path)}var o=e("./url"),i=e("socket.io-parser"),s=e("./manager"),a=e("debug")("socket.io-client");t.exports=n=r;var u=n.managers={};n.protocol=i.protocol,n.connect=r,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":2,"./socket":4,"./url":5,debug:14,"socket.io-parser":40}],2:[function(e,t,n){function r(e,t){return this instanceof r?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new r(e,t)}var o=e("engine.io-client"),i=e("./socket"),s=e("component-emitter"),a=e("socket.io-parser"),u=e("./on"),c=e("component-bind"),l=e("debug")("socket.io-client:manager"),h=e("indexof"),f=e("backo2"),p=Object.prototype.hasOwnProperty;t.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},s(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=o(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=u(t,"open",function(){n.onopen(),e&&e()}),i=u(t,"error",function(t){if(l("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;l("connect attempt will timeout after %d",s);var a=setTimeout(function(){l("connect attempt timed out after %d",s),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(r),this.subs.push(i),this},r.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",c(this,"ondata"))),this.subs.push(u(e,"ping",c(this,"onping"))),this.subs.push(u(e,"pong",c(this,"onpong"))),this.subs.push(u(e,"error",c(this,"onerror"))),this.subs.push(u(e,"close",c(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",c(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},r.prototype.socket=function(e){function t(){~h(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[e];if(!n){n=new i(this,e),this.nsps[e]=n;var r=this;n.on("connecting",t),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&t()}return n},r.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){l("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){l("cleanup");for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":3,"./socket":4,backo2:8,"component-bind":11,"component-emitter":12,debug:14,"engine.io-client":16,indexof:32,"socket.io-parser":40}],3:[function(e,t,n){function r(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=r},{}],4:[function(e,t,n){function r(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}var o=e("socket.io-parser"),i=e("component-emitter"),s=e("to-array"),a=e("./on"),u=e("component-bind"),c=e("debug")("socket.io-client:socket"),l=e("has-binary");t.exports=n=r;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;i(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",u(this,"onopen")),a(e,"packet",u(this,"onpacket")),a(e,"close",u(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(h.hasOwnProperty(e))return f.apply(this,arguments),this;var t=s(arguments),n=o.EVENT;l(t)&&(n=o.BINARY_EVENT);var r={type:n,data:t};return r.options={},r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:o.CONNECT})},r.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:this.onevent(e);break;case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:this.onack(e);break;case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);c("sending ack %j",r);var i=l(r)?o.BINARY_ACK:o.ACK;t.packet({type:i,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},{"./on":3,"component-bind":11,"component-emitter":12,debug:14,"has-binary":30,"socket.io-parser":40,"to-array":43}],5:[function(e,t,n){(function(n){function r(e,t){var r=e,t=t||n.location;null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),r=o(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=r.host.indexOf(":")!==-1,a=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port,r.href=r.protocol+"://"+a+(t&&t.port==r.port?"":":"+r.port),r}var o=e("parseuri"),i=e("debug")("socket.io-client:url");t.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{debug:14,parseuri:38}],6:[function(e,t,n){function r(e,t,n){function r(e,o){if(r.count<=0)throw new Error("after called too many times");--r.count,e?(i=!0,t(e),t=n):0!==r.count||i||t(null,o)}var i=!1;return n=n||o,r.count=e,0===e?t():r}function o(){}t.exports=r},{}],7:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},{}],8:[function(e,t,n){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],9:[function(e,t,n){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=new Uint8Array(256),r=0;r<e.length;r++)t[e.charCodeAt(r)]=r;n.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},n.decode=function(e){var n,r,o,i,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),h=new Uint8Array(l);for(n=0;n<u;n+=4)r=t[e.charCodeAt(n)],o=t[e.charCodeAt(n+1)],i=t[e.charCodeAt(n+2)],s=t[e.charCodeAt(n+3)],h[c++]=r<<2|o>>4,h[c++]=(15&o)<<4|i>>2,h[c++]=(3&i)<<6|63&s;return l}}()},{}],10:[function(e,t,n){(function(e){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new i;n(e);for(var o=0;o<e.length;o++)r.append(e[o]);return t.type?r.getBlob(t.type):r.getBlob()}function o(e,t){return n(e),new Blob(e,t||{})}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(t){return!1}}(),a=s&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(t){return!1}}(),u=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return s?a?e.Blob:o:u?r:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],11:[function(e,t,n){var r=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],12:[function(e,t,n){function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],13:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],14:[function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(t){}}function a(){var e;try{e=n.storage.debug}catch(t){}return e}function u(){try{return window.localStorage}catch(e){}}n=t.exports=e("./debug"),n.log=i,n.formatArgs=o,n.save=s,n.load=a,n.useColors=r,n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(a())},{"./debug":15}],15:[function(e,t,n){function r(){return n.colors[l++%n.colors.length]}function o(e){function t(){}function o(){var e=o,t=+new Date,i=t-(c||t);e.diff=i,e.prev=c,e.curr=t,c=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=r());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,r){if("%%"===t)return t;a++;var o=n.formatters[r];if("function"==typeof o){var i=s[a];t=o.call(e,i),s.splice(a,1),a--}return t}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(e,s));var u=o.log||n.log||void 0;u.apply(e,s)}t.enabled=!1,o.enabled=!0;var i=n.enabled(e)?o:t;return i.namespace=e,i}function i(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),r=t.length,o=0;o<r;o++)t[o]&&(e=t[o].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function s(){n.enable("")}function a(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=o,n.coerce=u,n.disable=s,n.enable=i,n.enabled=a,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var c,l=0},{ms:35}],16:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":17}],17:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":18,"engine.io-parser":27}],18:[function(e,t,n){(function(n){function r(e,t){if(!(this instanceof r))return new r(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized;var o="object"==typeof n&&n;o.global===o&&t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),this.open()}function o(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var i=e("./transports"),s=e("component-emitter"),a=e("debug")("engine.io-client:socket"),u=e("indexof"),c=e("engine.io-parser"),l=e("parseuri"),h=e("parsejson"),f=e("parseqs");t.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=c.protocol,r.Socket=r,r.Transport=e("./transport"),r.transports=e("./transports"),r.parser=e("engine.io-parser"),r.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=o(this.query);t.EIO=c.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new i[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(f.onlyBinaryUpgrades){var t=!this.supportsBinary&&f.transport.supportsBinary;h=h||t}h||(a('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!h)if("pong"==t.type&&"probe"==t.data){if(a('probe transport "%s" pong',e),f.upgrading=!0,f.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"==l.name,a('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){h||"closed"!=f.readyState&&(a("changing transport and sending upgrade packet"),c(),f.setTransport(l),l.send([{type:"upgrade"}]),f.emit("upgrade",l),l=null,f.upgrading=!1,f.flush())})}else{a('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,f.emit("upgradeError",n)}}))}function n(){h||(h=!0,c(),l.close(),l=null)}function o(t){var r=new Error("probe error: "+t);r.transport=l.name,n(),a('probe transport "%s" failed because of error: %s',e,t),f.emit("upgradeError",r)}function i(){o("transport closed")}function s(){o("socket closed")}function u(e){l&&e.name!=l.name&&(a('"%s" works - aborting "%s"',e.name,l.name),n())}function c(){l.removeListener("open",t),l.removeListener("error",o),l.removeListener("close",i),f.removeListener("close",s),f.removeListener("upgrading",u)}a('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),h=!1,f=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",o),l.once("close",i),this.once("close",s),this.once("upgrading",u),l.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(h(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){n=n||{},n.compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){a("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~u(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./transport":19,"./transports":20,"component-emitter":26,debug:14,"engine.io-parser":27,indexof:32,parsejson:36,parseqs:37,parseuri:38}],19:[function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}var o=e("engine.io-parser"),i=e("component-emitter");t.exports=r,i(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":26,"engine.io-parser":27}],20:[function(e,t,n){(function(t){function r(e){var n,r=!1,a=!1,u=!1!==e.jsonp;if(t.location){var c="https:"==location.protocol,l=location.port;l||(l=c?443:80),r=e.hostname!=location.hostname||l!=e.port,a=e.secure!=c}if(e.xdomain=r,e.xscheme=a,n=new o(e),"open"in n&&!e.forceJSONP)return new i(e);if(!u)throw new Error("JSONP disabled");return new s(e)}var o=e("xmlhttprequest-ssl"),i=e("./polling-xhr"),s=e("./polling-jsonp"),a=e("./websocket");n.polling=r,n.websocket=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling-jsonp":21,"./polling-xhr":22,"./websocket":24,"xmlhttprequest-ssl":25}],21:[function(e,t,n){(function(n){function r(){}function o(e){i.call(this,e),this.query=this.query||{},a||(n.___eio||(n.___eio=[]),a=n.___eio),this.index=a.length;var t=this;a.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=r)},!1)}var i=e("./polling"),s=e("component-inherit");t.exports=o;var a,u=/\n/g,c=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),
this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(t)}catch(e){i=document.createElement("iframe"),i.name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),e=e.replace(c,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(h){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":23,"component-inherit":13}],22:[function(e,t,n){(function(n){function r(){}function o(e){if(u.call(this,e),n.location){var t="https:"==location.protocol,r=location.port;r||(r=t?443:80),this.xd=e.hostname!=n.location.hostname||r!=e.port,this.xs=e.secure!=t}else this.extraHeaders=e.extraHeaders}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var a=e("xmlhttprequest-ssl"),u=e("./polling"),c=e("component-emitter"),l=e("component-inherit"),h=e("debug")("engine.io-client:polling-xhr");t.exports=o,t.exports.Request=i,l(o,u),o.prototype.supportsBinary=!0,o.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.extraHeaders=this.extraHeaders,new i(e)},o.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},o.prototype.doPoll=function(){h("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},c(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new a(e),r=this;try{h("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck(!0);for(var o in this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}}catch(s){}if(this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?r.onLoad():setTimeout(function(){r.onError(t.status)},0))},h("xhr data %s",this.data),t.send(this.data)}catch(s){return void setTimeout(function(){r.onError(s)},0)}n.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(t){}n.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}if("application/octet-stream"===t)e=this.xhr.response;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(n){for(var r=new Uint8Array(this.xhr.response),o=[],i=0,s=r.length;i<s;i++)o.push(r[i]);e=String.fromCharCode.apply(null,o)}else e=this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},n.document&&(i.requestsCount=0,i.requests={},n.attachEvent?n.attachEvent("onunload",s):n.addEventListener&&n.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":23,"component-emitter":26,"component-inherit":13,debug:14,"xmlhttprequest-ssl":25}],23:[function(e,t,n){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),o.call(this,e)}var o=e("../transport"),i=e("parseqs"),s=e("engine.io-parser"),a=e("component-inherit"),u=e("yeast"),c=e("debug")("engine.io-client:polling");t.exports=r;var l=function(){var t=e("xmlhttprequest-ssl"),n=new t({xdomain:!1});return null!=n.responseType}();a(r,o),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){c("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||t()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;c("polling got data %s",e);var n=function(e,n,r){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){c("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:37,"xmlhttprequest-ssl":25,yeast:45}],24:[function(e,t,n){(function(n){function r(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,o.call(this,e)}var o=e("../transport"),i=e("engine.io-parser"),s=e("parseqs"),a=e("component-inherit"),u=e("yeast"),c=e("debug")("engine.io-client:websocket"),l=n.WebSocket||n.MozWebSocket,h=l;if(!h&&"undefined"==typeof window)try{h=e("ws")}catch(f){}t.exports=r,a(r,o),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.ws=l?new h(e):new h(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(r.prototype.onData=function(e){var t=this;setTimeout(function(){o.prototype.onData.call(t,e)},0)}),r.prototype.write=function(e){function t(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var o=e.length,s=0,a=o;s<a;s++)!function(e){i.encodePacket(e,r.supportsBinary,function(i){if(!l){var s={};if(e.options&&(s.compress=e.options.compress),r.perMessageDeflate){var a="string"==typeof i?n.Buffer.byteLength(i):i.length;a<r.perMessageDeflate.threshold&&(s.compress=!1)}}try{l?r.ws.send(i):r.ws.send(i,s)}catch(u){c("websocket closed before onclose event")}--o||t()})}(e[s])},r.prototype.onClose=function(){o.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===r.prototype.name)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:37,ws:void 0,yeast:45}],25:[function(e,t,n){var r=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(i){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(i){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}},{"has-cors":31}],26:[function(e,t,n){function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){r.off(e,n),t.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],27:[function(e,t,n){(function(t){function r(e,t){var r="b"+n.packets[e.type]+e.data.data;return t(r)}function o(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=g[e.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}function i(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,n.encodePacket(e,t,!0,r)},o.readAsArrayBuffer(e.data)}function s(e,t,r){if(!t)return n.encodeBase64Packet(e,r);if(v)return i(e,t,r);var o=new Uint8Array(1);o[0]=g[e.type];var s=new b([o.buffer,e.data]);return r(s)}function a(e,t,n){for(var r=new Array(e.length),o=f(e.length,n),i=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},s=0;s<e.length;s++)i(s,e[s],o)}var u=e("./keys"),c=e("has-binary"),l=e("arraybuffer.slice"),h=e("base64-arraybuffer"),f=e("after"),p=e("utf8"),d=navigator.userAgent.match(/Android/i),y=/PhantomJS/i.test(navigator.userAgent),v=d||y;n.protocol=3;var g=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},m=u(g),w={type:"error",data:"parser error"},b=e("blob");n.encodePacket=function(e,n,i,a){"function"==typeof n&&(a=n,n=!1),"function"==typeof i&&(a=i,i=null);var u=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&u instanceof ArrayBuffer)return o(e,n,a);if(b&&u instanceof t.Blob)return s(e,n,a);if(u&&u.base64)return r(e,a);var c=g[e.type];return void 0!==e.data&&(c+=i?p.encode(String(e.data)):String(e.data)),a(""+c)},n.encodeBase64Packet=function(e,r){var o="b"+n.packets[e.type];if(b&&e.data instanceof t.Blob){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(e.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(a){for(var u=new Uint8Array(e.data),c=new Array(u.length),l=0;l<u.length;l++)c[l]=u[l];s=String.fromCharCode.apply(null,c)}return o+=t.btoa(s),r(o)},n.decodePacket=function(e,t,r){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(r)try{e=p.decode(e)}catch(o){return w}var i=e.charAt(0);return Number(i)==i&&m[i]?e.length>1?{type:m[i],data:e.substring(1)}:{type:m[i]}:w}var s=new Uint8Array(e),i=s[0],a=l(e,1);return b&&"blob"===t&&(a=new b([a])),{type:m[i],data:a}},n.decodeBase64Packet=function(e,n){var r=m[e.charAt(0)];if(!t.ArrayBuffer)return{type:r,data:{base64:!0,data:e.substr(1)}};var o=h.decode(e.substr(1));return"blob"===n&&b&&(o=new b([o])),{type:r,data:o}},n.encodePayload=function(e,t,r){function o(e){return e.length+":"+e}function i(e,r){n.encodePacket(e,!!s&&t,!0,function(e){r(null,o(e))})}"function"==typeof t&&(r=t,t=null);var s=c(e);return t&&s?b&&!v?n.encodePayloadAsBlob(e,r):n.encodePayloadAsArrayBuffer(e,r):e.length?void a(e,i,function(e,t){return r(t.join(""))}):r("0:")},n.decodePayload=function(e,t,r){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,r);"function"==typeof t&&(r=t,t=null);var o;if(""==e)return r(w,0,1);for(var i,s,a="",u=0,c=e.length;u<c;u++){var l=e.charAt(u);if(":"!=l)a+=l;else{if(""==a||a!=(i=Number(a)))return r(w,0,1);if(s=e.substr(u+1,i),a!=s.length)return r(w,0,1);if(s.length){if(o=n.decodePacket(s,t,!0),w.type==o.type&&w.data==o.data)return r(w,0,1);var h=r(o,u+i,c);if(!1===h)return}u+=i,a=""}}return""!=a?r(w,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){function r(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void a(e,r,function(e,n){var r=n.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),o=new Uint8Array(r),i=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}t?o[i++]=0:o[i++]=1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]}),t(o.buffer)}):t(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(e,t){function r(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,n[0]=0}for(var i=e instanceof ArrayBuffer?e.byteLength:e.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++)a[o]=parseInt(s[o]);if(a[s.length]=255,b){var u=new b([n.buffer,a.buffer,e]);t(null,u)}})}a(e,r,function(e,n){return t(new b(n))})},n.decodePayloadAsBinary=function(e,t,r){"function"==typeof t&&(r=t,t=null);for(var o=e,i=[],s=!1;o.byteLength>0;){for(var a=new Uint8Array(o),u=0===a[0],c="",h=1;255!=a[h];h++){if(c.length>310){s=!0;break}c+=a[h]}if(s)return r(w,0,1);o=l(o,2+c.length),c=parseInt(c);var f=l(o,0,c);if(u)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(p){var d=new Uint8Array(f);f="";for(var h=0;h<d.length;h++)f+=String.fromCharCode(d[h])}i.push(f),o=l(o,c)}var y=i.length;i.forEach(function(e,o){r(n.decodePacket(e,t,!0),o,y)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./keys":28,after:6,"arraybuffer.slice":7,"base64-arraybuffer":9,blob:10,"has-binary":29,utf8:44}],28:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},{}],29:[function(e,t,n){(function(n){function r(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(o(e)){for(var r=0;r<e.length;r++)if(t(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0}return!1}return t(e)}var o=e("isarray");t.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:33}],30:[function(e,t,n){(function(n){function r(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(o(e)){for(var r=0;r<e.length;r++)if(t(e[r]))return!0}else if(e&&"object"==typeof e){e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON());for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0}return!1}return t(e)}var o=e("isarray");t.exports=r}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:33}],31:[function(e,t,n){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(r){t.exports=!1}},{}],32:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],33:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],34:[function(t,n,r){(function(t){(function(){function o(e,t){function n(e){if(n[e]!==v)return n[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=n("json-stringify")&&n("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var u=t.stringify,l="function"==typeof u&&w;if(l){(s=function(){return 1}).toJSON=s;try{l="0"===u(0)&&"0"===u(new r)&&'""'==u(new i)&&u(m)===v&&u(v)===v&&u()===v&&"1"===u(s)&&"[1]"==u([s])&&"[null]"==u([v])&&"null"==u(null)&&"[null,null,null]"==u([v,m,null])&&u({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===u(null,s)&&"[\n 1,\n 2\n]"==u([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==u(new c((-864e13)))&&'"+275760-09-13T00:00:00.000Z"'==u(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==u(new c((-621987552e5)))&&'"1969-12-31T23:59:59.999Z"'==u(new c((-1)))}catch(h){l=!1}}o=l}if("json-parse"==e){var f=t.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){s=f(a);var p=5==s.a.length&&1===s.a[0];if(p){try{p=!f('"\t"')}catch(h){}if(p)try{p=1!==f("01")}catch(h){}if(p)try{p=1!==f("1.")}catch(h){}}}}catch(h){p=!1}o=p}}return n[e]=!!o}e||(e=u.Object()),t||(t=u.Object());var r=e.Number||u.Number,i=e.String||u.String,a=e.Object||u.Object,c=e.Date||u.Date,l=e.SyntaxError||u.SyntaxError,h=e.TypeError||u.TypeError,f=e.Math||u.Math,p=e.JSON||u.JSON;"object"==typeof p&&p&&(t.stringify=p.stringify,t.parse=p.parse);var d,y,v,g=a.prototype,m=g.toString,w=new c((-0xc782b5b800cec));try{w=w.getUTCFullYear()==-109252&&0===w.getUTCMonth()&&1===w.getUTCDate()&&10==w.getUTCHours()&&37==w.getUTCMinutes()&&6==w.getUTCSeconds()&&708==w.getUTCMilliseconds()}catch(b){}if(!n("json")){var k="[object Function]",_="[object Date]",C="[object Number]",A="[object String]",E="[object Array]",N="[object Boolean]",S=n("bug-string-char-index");if(!w)var P=f.floor,O=[0,31,59,90,120,151,181,212,243,273,304,334],R=function(e,t){return O[t]+365*(e-1970)+P((e-1969+(t=+(t>1)))/4)-P((e-1901+t)/100)+P((e-1601+t)/400)};if((d=g.hasOwnProperty)||(d=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=m?d=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,d=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,d.call(this,e)}),y=function(e,t){var n,r,o,i=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)d.call(r,o)&&i++;return n=r=null,i?y=2==i?function(e,t){var n,r={},o=m.call(e)==k;for(n in e)o&&"prototype"==n||d.call(r,n)||!(r[n]=1)||!d.call(e,n)||t(n)}:function(e,t){var n,r,o=m.call(e)==k;for(n in e)o&&"prototype"==n||!d.call(e,n)||(r="constructor"===n)||t(n);(r||d.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],y=function(e,t){var n,o,i=m.call(e)==k,a=!i&&"function"!=typeof e.constructor&&s[typeof e.hasOwnProperty]&&e.hasOwnProperty||d;for(n in e)i&&"prototype"==n||!a.call(e,n)||t(n);for(o=r.length;n=r[--o];a.call(e,n)&&t(n));}),y(e,t)},!n("json-stringify")){var D={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},x="000000",T=function(e,t){return(x+(t||0)).slice(-e)},U="\\u00",B=function(e){for(var t='"',n=0,r=e.length,o=!S||r>10,i=o&&(S?e.split(""):e);n<r;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=D[s];break;default:if(s<32){t+=U+T(2,s.toString(16));break}t+=o?i[n]:e.charAt(n)}}return t+'"'},j=function(e,t,n,r,o,i,s){var a,u,c,l,f,p,g,w,b,k,S,O,D,x,U,I;try{a=t[e]}catch(L){}if("object"==typeof a&&a)if(u=m.call(a),u!=_||d.call(a,"toJSON"))"function"==typeof a.toJSON&&(u!=C&&u!=A&&u!=E||d.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(R){for(f=P(a/864e5),c=P(f/365.2425)+1970-1;R(c+1,0)<=f;c++);for(l=P((f-R(c,0))/30.42);R(c,l+1)<=f;l++);f=1+f-R(c,l),p=(a%864e5+864e5)%864e5,g=P(p/36e5)%24,w=P(p/6e4)%60,b=P(p/1e3)%60,k=p%1e3}else c=a.getUTCFullYear(),l=a.getUTCMonth(),f=a.getUTCDate(),g=a.getUTCHours(),w=a.getUTCMinutes(),b=a.getUTCSeconds(),k=a.getUTCMilliseconds();a=(c<=0||c>=1e4?(c<0?"-":"+")+T(6,c<0?-c:c):T(4,c))+"-"+T(2,l+1)+"-"+T(2,f)+"T"+T(2,g)+":"+T(2,w)+":"+T(2,b)+"."+T(3,k)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if(u=m.call(a),u==N)return""+a;if(u==C)return a>-1/0&&a<1/0?""+a:"null";if(u==A)return B(""+a);if("object"==typeof a){for(x=s.length;x--;)if(s[x]===a)throw h();if(s.push(a),S=[],U=i,i+=o,u==E){for(D=0,x=a.length;D<x;D++)O=j(D,a,n,r,o,i,s),S.push(O===v?"null":O);I=S.length?o?"[\n"+i+S.join(",\n"+i)+"\n"+U+"]":"["+S.join(",")+"]":"[]"}else y(r||a,function(e){var t=j(e,a,n,r,o,i,s);t!==v&&S.push(B(e)+":"+(o?" ":"")+t)}),I=S.length?o?"{\n"+i+S.join(",\n"+i)+"\n"+U+"}":"{"+S.join(",")+"}":"{}";return s.pop(),I}};t.stringify=function(e,t,n){var r,o,i,a;if(s[typeof t]&&t)if((a=m.call(t))==k)o=t;else if(a==E){i={};for(var u,c=0,l=t.length;c<l;u=t[c++],a=m.call(u),(a==A||a==C)&&(i[u]=1));}if(n)if((a=m.call(n))==C){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else a==A&&(r=n.length<=10?n:n.slice(0,10));return j("",(u={},u[""]=e,u),o,i,r,"",[])}}if(!n("json-parse")){var I,L,M=i.fromCharCode,F={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},q=function(){throw I=L=null,l()},H=function(){for(var e,t,n,r,o,i=L,s=i.length;I<s;)switch(o=i.charCodeAt(I)){case 9:case 10:case 13:case 32:I++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?i.charAt(I):i[I],I++,e;case 34:for(e="@",I++;I<s;)if(o=i.charCodeAt(I),o<32)q();else if(92==o)switch(o=i.charCodeAt(++I)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=F[o],I++;break;case 117:for(t=++I,n=I+4;I<n;I++)o=i.charCodeAt(I),o>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||q();e+=M("0x"+i.slice(t,I));break;default:q()}else{if(34==o)break;for(o=i.charCodeAt(I),t=I;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++I);e+=i.slice(t,I)}if(34==i.charCodeAt(I))return I++,e;q();default:if(t=I,45==o&&(r=!0,o=i.charCodeAt(++I)),o>=48&&o<=57){for(48==o&&(o=i.charCodeAt(I+1),o>=48&&o<=57)&&q(),r=!1;I<s&&(o=i.charCodeAt(I),o>=48&&o<=57);I++);if(46==i.charCodeAt(I)){for(n=++I;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==I&&q(),I=n}if(o=i.charCodeAt(I),101==o||69==o){for(o=i.charCodeAt(++I),43!=o&&45!=o||I++,n=I;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==I&&q(),I=n}return+i.slice(t,I)}if(r&&q(),"true"==i.slice(I,I+4))return I+=4,!0;if("false"==i.slice(I,I+5))return I+=5,!1;if("null"==i.slice(I,I+4))return I+=4,null;q()}return"$"},z=function(e){var t,n;if("$"==e&&q(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=H(),"]"!=e;n||(n=!0))n&&(","==e?(e=H(),"]"==e&&q()):q()),","==e&&q(),t.push(z(e));return t}if("{"==e){for(t={};e=H(),"}"!=e;n||(n=!0))n&&(","==e?(e=H(),"}"==e&&q()):q()),","!=e&&"string"==typeof e&&"@"==(S?e.charAt(0):e[0])&&":"==H()||q(),t[e.slice(1)]=z(H());return t}q()}return e},J=function(e,t,n){var r=V(e,t,n);r===v?delete e[t]:e[t]=r},V=function(e,t,n){var r,o=e[t];if("object"==typeof o&&o)if(m.call(o)==E)for(r=o.length;r--;)J(o,r,n);else y(o,function(e){J(o,e,n)});return n.call(e,t,o)};t.parse=function(e,t){var n,r;return I=0,L=""+e,n=z(H()),"$"!=H()&&q(),I=L=null,t&&m.call(t)==k?V((r={},r[""]=n,r),"",t):n}}}return t.runInContext=o,t}var i="function"==typeof e&&e.amd,s={"function":!0,object:!0},a=s[typeof r]&&r&&!r.nodeType&&r,u=s[typeof window]&&window||this,c=a&&s[typeof n]&&n&&!n.nodeType&&"object"==typeof t&&t;if(!c||c.global!==c&&c.window!==c&&c.self!==c||(u=c),a&&!i)o(u,a);else{var l=u.JSON,h=u.JSON3,f=!1,p=o(u,u.JSON3={noConflict:function(){return f||(f=!0,u.JSON=l,u.JSON3=h,l=h=null),p}});u.JSON={parse:p.parse,stringify:p.stringify}}i&&e(function(){return p})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],35:[function(e,t,n){function r(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*h;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*u;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function o(e){return e>=l?Math.round(e/l)+"d":e>=c?Math.round(e/c)+"h":e>=u?Math.round(e/u)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return s(e,l,"day")||s(e,c,"hour")||s(e,u,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,u=60*a,c=60*u,l=24*c,h=365.25*l;t.exports=function(e,t){return t=t||{},"string"==typeof e?r(e):t["long"]?i(e):o(e)}},{}],36:[function(e,t,n){(function(e){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(r,"@").replace(o,"]").replace(i,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],37:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},{}],38:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),i=e.indexOf("]");n!=-1&&i!=-1&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));for(var s=r.exec(e||""),a={},u=14;u--;)a[o[u]]=s[u]||"";return n!=-1&&i!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],39:[function(e,t,n){(function(t){var r=e("isarray"),o=e("./is-buffer");n.deconstructPacket=function(e){function t(e){if(!e)return e;if(o(e)){var i={_placeholder:!0,num:n.length};return n.push(e),i}if(r(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a]);return s}if("object"==typeof e&&!(e instanceof Date)){var s={};for(var u in e)s[u]=t(e[u]);return s}return e}var n=[],i=e.data,s=e;return s.data=t(i),s.attachments=n.length,{packet:s,buffers:n}},n.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var o=t[e.num];return o}if(r(e)){for(var i=0;i<e.length;i++)e[i]=n(e[i]);return e}if(e&&"object"==typeof e){for(var s in e)e[s]=n(e[s]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){function i(e,u,c){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var l=new FileReader;l.onload=function(){c?c[u]=this.result:a=this.result,--s||n(a)},l.readAsArrayBuffer(e)}else if(r(e))for(var h=0;h<e.length;h++)i(e[h],h,e);else if(e&&"object"==typeof e&&!o(e))for(var f in e)i(e[f],f,e)}var s=0,a=e;i(a),s||n(a)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./is-buffer":41,isarray:33}],40:[function(e,t,n){function r(){}function o(e){var t="",r=!1;return t+=e.type,n.BINARY_EVENT!=e.type&&n.BINARY_ACK!=e.type||(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(r=!0,t+=e.nsp),null!=e.id&&(r&&(t+=",",r=!1),t+=e.id),null!=e.data&&(r&&(t+=","),t+=h.stringify(e.data)),l("encoded %j as %s",e,t),t}function i(e,t){function n(e){var n=p.deconstructPacket(e),r=o(n.packet),i=n.buffers;i.unshift(r),t(i)}p.removeBlobs(e,n)}function s(){this.reconstructor=null}function a(e){
var t={},r=0;if(t.type=Number(e.charAt(0)),null==n.types[t.type])return c();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var o="";"-"!=e.charAt(++r)&&(o+=e.charAt(r),r!=e.length););if(o!=Number(o)||"-"!=e.charAt(r))throw new Error("Illegal attachments");t.attachments=Number(o)}if("/"==e.charAt(r+1))for(t.nsp="";++r;){var i=e.charAt(r);if(","==i)break;if(t.nsp+=i,r==e.length)break}else t.nsp="/";var s=e.charAt(r+1);if(""!==s&&Number(s)==s){for(t.id="";++r;){var i=e.charAt(r);if(null==i||Number(i)!=i){--r;break}if(t.id+=e.charAt(r),r==e.length)break}t.id=Number(t.id)}if(e.charAt(++r))try{t.data=h.parse(e.substr(r))}catch(a){return c()}return l("decoded %s as %j",e,t),t}function u(e){this.reconPack=e,this.buffers=[]}function c(e){return{type:n.ERROR,data:"parser error"}}var l=e("debug")("socket.io-parser"),h=e("json3"),f=(e("isarray"),e("component-emitter")),p=e("./binary"),d=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=r,n.Decoder=s,r.prototype.encode=function(e,t){if(l("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)i(e,t);else{var r=o(e);t([r])}},f(s.prototype),s.prototype.add=function(e){var t;if("string"==typeof e)t=a(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new u(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!d(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":39,"./is-buffer":41,"component-emitter":42,debug:14,isarray:33,json3:34}],41:[function(e,t,n){(function(e){function n(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],42:[function(e,t,n){arguments[4][26][0].apply(n,arguments)},{dup:26}],43:[function(e,t,n){function r(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}t.exports=r},{}],44:[function(t,n,r){(function(t){!function(o){function i(e){for(var t,n,r=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function s(e){for(var t,n=e.length,r=-1,o="";++r<n;)t=e[r],t>65535&&(t-=65536,o+=b(t>>>10&1023|55296),t=56320|1023&t),o+=b(t);return o}function a(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function u(e,t){return b(e>>t&63|128)}function c(e){if(0==(4294967168&e))return b(e);var t="";return 0==(4294965248&e)?t=b(e>>6&31|192):0==(4294901760&e)?(a(e),t=b(e>>12&15|224),t+=u(e,6)):0==(4292870144&e)&&(t=b(e>>18&7|240),t+=u(e,12),t+=u(e,6)),t+=b(63&e|128)}function l(e){for(var t,n=i(e),r=n.length,o=-1,s="";++o<r;)t=n[o],s+=c(t);return s}function h(){if(w>=m)throw Error("Invalid byte index");var e=255&g[w];if(w++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function f(){var e,t,n,r,o;if(w>m)throw Error("Invalid byte index");if(w==m)return!1;if(e=255&g[w],w++,0==(128&e))return e;if(192==(224&e)){var t=h();if(o=(31&e)<<6|t,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=h(),n=h(),o=(15&e)<<12|t<<6|n,o>=2048)return a(o),o;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=h(),n=h(),r=h(),o=(15&e)<<18|t<<12|n<<6|r,o>=65536&&o<=1114111))return o;throw Error("Invalid UTF-8 detected")}function p(e){g=i(e),m=g.length,w=0;for(var t,n=[];(t=f())!==!1;)n.push(t);return s(n)}var d="object"==typeof r&&r,y="object"==typeof n&&n&&n.exports==d&&n,v="object"==typeof t&&t;v.global!==v&&v.window!==v||(o=v);var g,m,w,b=String.fromCharCode,k={version:"2.0.0",encode:l,decode:p};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return k});else if(d&&!d.nodeType)if(y)y.exports=k;else{var _={},C=_.hasOwnProperty;for(var A in k)C.call(k,A)&&(d[A]=k[A])}else o.utf8=k}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],45:[function(e,t,n){"use strict";function r(e){var t="";do t=a[e%u]+t,e=Math.floor(e/u);while(e>0);return t}function o(e){var t=0;for(h=0;h<e.length;h++)t=t*u+c[e.charAt(h)];return t}function i(){var e=r(+new Date);return e!==s?(l=0,s=e):e+"."+r(l++)}for(var s,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),u=64,c={},l=0,h=0;h<u;h++)c[a[h]]=h;i.encode=r,i.decode=o,t.exports=i},{}]},{},[1])(1)}),function(){this.wedeploy=this.wedeploy||{},this.wedeployNamed=this.wedeployNamed||{};var e={};e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},e.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),e.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},e.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},e.slicedToArray=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e.toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,null,[{key:"abstractMethod",value:function(){throw Error("Unimplemented abstract method")}},{key:"collectSuperClassesProperty",value:function(e,t){for(var n=[e[t]];e.__proto__&&!e.__proto__.isPrototypeOf(Function);)e=e.__proto__,n.push(e[t]);return n}},{key:"getFunctionName",value:function(e){if(!e.name){var t=e.toString();e.name=t.substring(9,t.indexOf("("))}return e.name}},{key:"getUid",value:function(e,n){if(e){var r=e[t.UID_PROPERTY];return n&&!e.hasOwnProperty(t.UID_PROPERTY)&&(r=null),r||(e[t.UID_PROPERTY]=t.uniqueIdCounter_++)}return t.uniqueIdCounter_++}},{key:"identityFunction",value:function(e){return e}},{key:"isBoolean",value:function(e){return"boolean"==typeof e}},{key:"isDef",value:function(e){return void 0!==e}},{key:"isDefAndNotNull",value:function(e){return t.isDef(e)&&!t.isNull(e)}},{key:"isDocument",value:function(t){return t&&"object"===("undefined"==typeof t?"undefined":e["typeof"](t))&&9===t.nodeType}},{key:"isElement",value:function(t){return t&&"object"===("undefined"==typeof t?"undefined":e["typeof"](t))&&1===t.nodeType}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isNull",value:function(e){return null===e}},{key:"isNumber",value:function(e){return"number"==typeof e}},{key:"isWindow",value:function(e){return null!==e&&e===e.window}},{key:"isObject",value:function(t){var n="undefined"==typeof t?"undefined":e["typeof"](t);return"object"===n&&null!==t||"function"===n}},{key:"isPromise",value:function(t){return t&&"object"===("undefined"==typeof t?"undefined":e["typeof"](t))&&"function"==typeof t.then}},{key:"isString",value:function(e){return"string"==typeof e||e instanceof String}},{key:"mergeSuperClassesProperty",value:function(e,n,r){var o=n+"_MERGED";if(e.hasOwnProperty(o))return!1;var i=t.collectSuperClassesProperty(e,n);return r&&(i=r(i)),e[o]=i,!0}},{key:"nullFunction",value:function(){}}]),t}();t.UID_PROPERTY="core_"+(1e9*Math.random()>>>0),t.uniqueIdCounter_=1,this.wedeploy.core=t}.call(this),function(){var t=this.wedeploy.core,n=function(){function n(){e.classCallCheck(this,n)}return e.createClass(n,null,[{key:"equal",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},{key:"firstDefinedValue",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t])return e[t]}},{key:"flatten",value:function(e,t){for(var r=t||[],o=0;o<e.length;o++)Array.isArray(e[o])?n.flatten(e[o],r):r.push(e[o]);return r}},{key:"remove",value:function(e,t){var r,o=e.indexOf(t);return(r=o>=0)&&n.removeAt(e,o),r}},{key:"removeAt",value:function(e,t){return 1===Array.prototype.splice.call(e,t,1).length}},{key:"slice",value:function(e,n,r){for(var o=[],i=t.isDef(r)?r:e.length,s=n;s<i;s++)o.push(e[s]);return o}}]),n}();this.wedeploy.array=n}.call(this),function(){var e={};e.throwException=function(t){e.nextTick(function(){throw t})},e.run=function(t,n){e.run.workQueueScheduled_||(e.nextTick(e.run.processWorkQueue),e.run.workQueueScheduled_=!0),e.run.workQueue_.push(new e.run.WorkItem_(t,n))},e.run.workQueueScheduled_=!1,e.run.workQueue_=[],e.run.processWorkQueue=function(){for(;e.run.workQueue_.length;){var t=e.run.workQueue_;e.run.workQueue_=[];for(var n=0;n<t.length;n++){var r=t[n];try{r.fn.call(r.scope)}catch(o){e.throwException(o)}}}e.run.workQueueScheduled_=!1},e.run.WorkItem_=function(e,t){this.fn=e,this.scope=t},e.nextTick=function(t,n){var r=t;return n&&(r=t.bind(n)),r=e.nextTick.wrapCallback_(r),"function"==typeof setImmediate?void setImmediate(r):(e.nextTick.setImmediate_||(e.nextTick.setImmediate_=e.nextTick.getSetImmediateEmulator_()),void e.nextTick.setImmediate_(r))},e.nextTick.setImmediate_=null,e.nextTick.getSetImmediateEmulator_=function(){var e;if("function"==typeof MessageChannel&&(e=MessageChannel),"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(e=function(){var e=document.createElement("iframe");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,n=t.document;n.open(),n.write(""),n.close();var r="callImmediate"+Math.random(),o=t.location.protocol+"//"+t.location.host,i=function(e){e.origin!==o&&e.data!==r||this.port1.onmessage()}.bind(this);t.addEventListener("message",i,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(r,o)}}}),"undefined"!=typeof e){var t=new e,n={},r=n;return t.port1.onmessage=function(){n=n.next;var e=n.cb;n.cb=null,e()},function(e){r.next={cb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){setTimeout(e,0)}},e.nextTick.wrapCallback_=function(e){return e},this.wedeploy.async=e}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t),this.disposed_=!1}return e.createClass(t,[{key:"dispose",value:function(){this.disposed_||(this.disposeInternal(),this.disposed_=!0)}},{key:"disposeInternal",value:function(){}},{key:"isDisposed",value:function(){return this.disposed_}}]),t}();this.wedeploy.Disposable=t}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,null,[{key:"mixin",value:function(e){for(var t,n,r=1;r<arguments.length;r++){n=arguments[r];for(t in n)e[t]=n[t]}return e}},{key:"getObjectByName",value:function(e,t){var n=t||window,r=e.split(".");return r.reduce(function(e,t){return e[t]},n)}},{key:"map",value:function(e,t){for(var n={},r=Object.keys(e),o=0;o<r.length;o++)n[r[o]]=t(r[o],e[r[o]]);return n}},{key:"shallowEqual",value:function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(e[n[o]]!==t[n[o]])return!1;return!0}}]),t}();this.wedeploy.object=t}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,null,[{key:"collapseBreakingSpaces",value:function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}},{key:"escapeRegex",value:function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}},{key:"getRandomString",value:function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^Date.now()).toString(36)}},{key:"hashCode",value:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t=31*t+e.charCodeAt(n),t%=4294967296;return t}},{key:"replaceInterval",value:function(e,t,n,r){return e.substring(0,t)+r+e.substring(n)}}]),t}();this.wedeploy.string=t}.call(this),function(){var e=this.wedeploy.core,t=this.wedeploy.array,n=this.wedeploy.async,r=this.wedeploy.Disposable,o=this.wedeploy.object,i=this.wedeploy.string;this.wedeploy.metal=e,this.wedeployNamed.metal=this.wedeployNamed.metal||{},this.wedeployNamed.metal.core=e,this.wedeployNamed.metal.array=t,this.wedeployNamed.metal.async=n,this.wedeployNamed.metal.Disposable=r,this.wedeployNamed.metal.object=o,this.wedeployNamed.metal.string=i}.call(this),function(){var t=this.wedeployNamed.metal.Disposable,n=Object.create,r=function(t){function r(){e.classCallCheck(this,r);var t=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.keys=n(null),t.values=n(null),t}return e.inherits(r,t),e.createClass(r,[{key:"add",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=this.values[e.toLowerCase()]||[],this.values[e.toLowerCase()].push(t),this}},{key:"clear",value:function(){return this.keys=n(null),this.values=n(null),this}},{key:"contains",value:function(e){return e.toLowerCase()in this.values}},{key:"disposeInternal",value:function(){this.values=null}},{key:"get",value:function(e){var t=this.values[e.toLowerCase()];if(t)return t[0]}},{key:"getAll",value:function(e){return this.values[e.toLowerCase()]}},{key:"isEmpty",value:function(){return 0===this.size()}},{key:"names",value:function(){var e=this;return Object.keys(this.values).map(function(t){return e.keys[t]})}},{key:"remove",value:function(e){return delete this.keys[e.toLowerCase()],delete this.values[e.toLowerCase()],this}},{key:"set",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=[t],this}},{key:"size",value:function(){return this.names().length}},{key:"toString",value:function(){return JSON.stringify(this.values)}}],[{key:"fromObject",value:function(e){for(var t=new r,n=Object.keys(e),o=0;o<n.length;o++)t.set(n[o],e[n[o]]);return t}}]),r}(t);this.wedeploy.MultiMap=r}.call(this),function(){var t=this.wedeployNamed.metal.array,n=function(){function n(t){e.classCallCheck(this,n),this.value_=t,this.parent_=null,this.children_=null}return e.createClass(n,[{key:"addChild",value:function(e){r(e),e.setParent(this),this.children_=this.children_||[],this.children_.push(e)}},{key:"contains",value:function(e){for(var t=e.getParent();t;){if(t===this)return!0;t=t.getParent()}return!1}},{key:"getAncestors",value:function(){for(var e=[],t=this.getParent();t;)e.push(t),t=t.getParent();return e}},{key:"getChildAt",value:function(e){return this.getChildren()[e]||null}},{key:"getChildren",value:function(){return this.children_||n.EMPTY_ARRAY}},{key:"getChildCount",value:function(){return this.getChildren().length}},{key:"getDepth",value:function(){for(var e=0,t=this;t.getParent();)e++,t=t.getParent();return e}},{key:"getParent",value:function(){return this.parent_}},{key:"getRoot",value:function(){for(var e=this;e.getParent();)e=e.getParent();return e}},{key:"getValue",value:function(){return this.value_}},{key:"isLeaf",value:function(){return!this.getChildCount()}},{key:"removeChild",value:function(e){return t.remove(this.getChildren(),e)?e:null}},{key:"setParent",value:function(e){this.parent_=e}},{key:"traverse",value:function(e,t){e&&e(this),this.getChildren().forEach(function(n){return n.traverse(e,t)}),t&&t(this)}}]),n}();n.EMPTY_ARRAY=[];var r=function(e){if(e.getParent())throw new Error("Cannot add child with parent.")};this.wedeploy.TreeNode=n}.call(this),function(){var e=this.wedeploy.MultiMap,t=this.wedeploy.TreeNode;this.wedeployNamed.structs=this.wedeployNamed.structs||{},this.wedeployNamed.structs.MultiMap=e,this.wedeployNamed.structs.TreeNode=t}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeployNamed.structs.MultiMap,r=function(){function r(){e.classCallCheck(this,r),this.headers_=new n}return e.createClass(r,[{key:"body",value:function(e){return t.isDef(e)?(this.body_=e,this):this.body_}},{key:"header",value:function(e,t){if(2!==arguments.length)throw new Error("Invalid arguments");return this.headers_.set(e,t),this}},{key:"headers",value:function(e){return t.isDef(e)?(e instanceof n?this.headers_=e:this.headers_.values=e,e):this.headers_}},{key:"removeBody",value:function(){this.body_=void 0}}]),r}();this.wedeploy.ClientMessage=r}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.ClientMessage,r=this.wedeployNamed.structs.MultiMap,o=function(n){function o(){e.classCallCheck(this,o);var t=e.possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return t.params_=new r,t.withCredentials_=!0,t}return e.inherits(o,n),e.createClass(o,[{key:"withCredentials",value:function(e){return t.isDef(e)?(this.withCredentials_=!!e,this):this.withCredentials_}},{key:"method",value:function(e){return t.isDef(e)?(this.method_=e,this):this.method_||o.DEFAULT_METHOD}},{key:"param",value:function(e,t){if(2!==arguments.length)throw new Error("Invalid arguments");return this.params_.set(e,t),this}},{key:"params",value:function(e){return t.isDef(e)?(e instanceof r?this.params_=e:this.params_.values=e,e):this.params_}},{key:"url",value:function(e){return t.isDef(e)?(this.url_=e,this):this.url_}}]),o}(n);o.DEFAULT_METHOD="GET",this.wedeploy.ClientRequest=o}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.ClientMessage,r=function(n){function r(t){e.classCallCheck(this,r);var n=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(!t)throw new Error("Can't create response without request");return n.clientRequest_=t,n}return e.inherits(r,n),e.createClass(r,[{key:"request",value:function(){return this.clientRequest_}},{key:"statusCode",value:function(e){return t.isDef(e)?(this.statusCode_=e,this):this.statusCode_}},{key:"statusText",value:function(e){return t.isDef(e)?(this.statusText_=e,this):this.statusText_}},{key:"succeeded",value:function(){return this.statusCode()>=200&&this.statusCode()<=399}}]),r}(n);this.wedeploy.ClientResponse=r}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,[{key:"send",value:function(){}}]),t}();this.wedeploy.Transport=t}.call(this),function(){function e(e){var t=document.createElement("a");return t.href=e,{hash:t.hash,hostname:t.hostname,password:t.password,pathname:"/"===t.pathname[0]?t.pathname:"/"+t.pathname,port:t.port,protocol:t.protocol,search:t.search,username:t.username}}this.wedeploy.parseFromAnchor=e}.call(this),function(){function e(e){return t.isFunction(URL)&&URL.length?new URL(e):n(e)}var t=this.wedeployNamed.metal.core,n=this.wedeploy.parseFromAnchor;this.wedeploy.parse=e}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeployNamed.metal.string,r=this.wedeploy.parse,o=this.wedeployNamed.structs.MultiMap,i=r,s=function(){function r(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];e.classCallCheck(this,r),this.url=r.parse(this.maybeAddProtocolAndHostname_(t))}return e.createClass(r,[{key:"addParametersFromMultiMap",value:function(e){var t=this;return e.names().forEach(function(n){e.getAll(n).forEach(function(e){t.addParameterValue(n,e)})}),this}},{key:"addParameterValue",value:function(e,n){return this.ensureQueryInitialized_(),t.isDef(n)&&(n=String(n)),this.query.add(e,n),this}},{key:"addParameterValues",value:function(e,t){var n=this;return t.forEach(function(t){return n.addParameterValue(e,t)}),this}},{key:"ensureQueryInitialized_",value:function(){var n=this;if(!this.query){this.query=new o;var i=this.url.search;i&&i.substring(1).split("&").forEach(function(o){var i=o.split("="),s=e.slicedToArray(i,2),a=s[0],u=s[1];t.isDef(u)&&(u=r.urlDecode(u)),n.addParameterValue(a,u)})}}},{key:"getHash",value:function(){return this.url.hash||""}},{key:"getHost",value:function(){var e=this.getHostname();if(e){var t=this.getPort();t&&"80"!==t&&(e+=":"+t)}return e}},{key:"getHostname",value:function(){var e=this.url.hostname;return e===r.HOSTNAME_PLACEHOLDER?"":e}},{key:"getOrigin",value:function(){var e=this.getHost();return e?this.getProtocol()+"//"+e:""}},{key:"getParameterValue",value:function(e){return this.ensureQueryInitialized_(),this.query.get(e)}},{key:"getParameterValues",value:function(e){return this.ensureQueryInitialized_(),this.query.getAll(e)}},{key:"getParameterNames",value:function(){return this.ensureQueryInitialized_(),this.query.names()}},{key:"getPathname",value:function(){return this.url.pathname}},{key:"getPort",value:function(){return this.url.port}},{key:"getProtocol",value:function(){return this.url.protocol}},{key:"getSearch",value:function(){var e=this,n="",r="";return this.getParameterNames().forEach(function(n){e.getParameterValues(n).forEach(function(e){r+=n,t.isDef(e)&&(r+="="+encodeURIComponent(e)),r+="&"})}),r=r.slice(0,-1),r&&(n+="?"+r),n}},{key:"hasParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.contains(e)}},{key:"makeUnique",value:function(){return this.setParameterValue(r.RANDOM_PARAM,n.getRandomString()),this}},{key:"maybeAddProtocolAndHostname_",value:function(e){var t=e;if(e.indexOf("://")===-1&&0!==e.indexOf("javascript:"))switch(t=r.DEFAULT_PROTOCOL,"/"===e[0]&&"/"===e[1]||(t+="//"),e.charAt(0)){case".":case"?":case"#":t+=r.HOSTNAME_PLACEHOLDER,t+="/",t+=e;break;case"":case"/":"/"!==e[1]&&(t+=r.HOSTNAME_PLACEHOLDER),t+=e;break;default:t+=e}return t}},{key:"removeParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.remove(e),this}},{key:"removeUnique",value:function(){return this.removeParameter(r.RANDOM_PARAM),this}},{key:"setHash",value:function(e){return this.url.hash=e,this}},{key:"setHostname",value:function(e){return this.url.hostname=e,this}},{key:"setParameterValue",value:function(e,t){return this.removeParameter(e),this.addParameterValue(e,t),this}},{key:"setParameterValues",value:function(e,t){var n=this;return this.removeParameter(e),t.forEach(function(t){return n.addParameterValue(e,t)}),this}},{key:"setPathname",value:function(e){return this.url.pathname=e,this}},{key:"setPort",value:function(e){return this.url.port=e,this}},{key:"setProtocol",value:function(e){return this.url.protocol=e,":"!==this.url.protocol[this.url.protocol.length-1]&&(this.url.protocol+=":"),this}},{key:"toString",value:function(){var e="",t=this.getHost();return t&&(e+=this.getProtocol()+"//"),e+=t+this.getPathname()+this.getSearch()+this.getHash()}}],[{key:"getParseFn",value:function(){return i}},{key:"normalizeObject",value:function(e){var t=e.pathname?e.pathname.length:0;return t>1&&"/"===e.pathname[t-1]&&(e.pathname=e.pathname.substr(0,t-1)),e}},{key:"parse",value:function(e){return r.normalizeObject(i(e))}},{key:"setParseFn",value:function(e){i=e}},{key:"joinPaths",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),n=n.map(function(e){return"/"===e.charAt(0)?e.substring(1):e}),[e].concat(n).join("/").replace(/\/$/,"")}},{key:"urlDecode",value:function(e){return decodeURIComponent(e.replace(/\+/g," "))}}]),r}();s.DEFAULT_PROTOCOL="http:",s.HOSTNAME_PLACEHOLDER="hostname"+Date.now(),s.RANDOM_PARAM="zx",this.wedeploy.Uri=s}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeployNamed.metal.async,r=function(){};r.prototype.then=function(){},r.IMPLEMENTED_BY_PROP="$goog_Thenable",r.addImplementation=function(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0},r.isImplementedBy=function(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}};var o=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),e.apply(this,n)}},i=function s(e,t){this.state_=s.State_.PENDING,this.result_=void 0,this.parent_=null,this.callbackEntries_=null,this.executing_=!1,s.UNHANDLED_REJECTION_DELAY>0?this.unhandledRejectionId_=0:0===s.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1);try{var n=this;e.call(t,function(e){n.resolve_(s.State_.FULFILLED,e)},function(e){n.resolve_(s.State_.REJECTED,e)})}catch(r){this.resolve_(s.State_.REJECTED,r)}};i.UNHANDLED_REJECTION_DELAY=0,i.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3},i.CallbackEntry_=null,i.resolve=function(e){return new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.length||t(void 0);for(var r,o=0;r=e[o];o++)r.then(t,n)})},i.all=function(e){return new i(function(t,n){var r=e.length,i=[];if(!r)return void t(i);for(var s,a=function(e,n){r--,i[e]=n,0===r&&t(i)},u=function(e){n(e)},c=0;s=e[c];c++)s.then(o(a,c),u)})},i.firstFulfilled=function(e){return new i(function(t,n){var r=e.length,i=[];if(!r)return void t(void 0);for(var s,a=function(e){t(e)},u=function(e,t){r--,i[e]=t,0===r&&n(i)},c=0;s=e[c];c++)s.then(a,o(u,c))})},i.prototype.then=function(e,n,r){return this.addChildPromise_(t.isFunction(e)?e:null,t.isFunction(n)?n:null,r)},r.addImplementation(i),i.prototype.thenAlways=function(e,t){var n=function(){try{e.call(t)}catch(n){i.handleRejection_.call(null,n)}};return this.addCallbackEntry_({child:null,onRejected:n,onFulfilled:n}),this},i.prototype.thenCatch=function(e,t){return this.addChildPromise_(null,e,t)},i.prototype["catch"]=i.prototype.thenCatch,i.prototype.cancel=function(e){this.state_===i.State_.PENDING&&n.run(function(){var t=new i.CancellationError(e);t.IS_CANCELLATION_ERROR=!0,this.cancelInternal_(t)},this)},i.prototype.cancelInternal_=function(e){this.state_===i.State_.PENDING&&(this.parent_?this.parent_.cancelChild_(this,e):this.resolve_(i.State_.REJECTED,e))},i.prototype.cancelChild_=function(e,t){if(this.callbackEntries_){for(var n,r=0,o=-1,s=0;n=this.callbackEntries_[s];s++){var a=n.child;if(a&&(r++,a===e&&(o=s),o>=0&&r>1))break}if(o>=0)if(this.state_===i.State_.PENDING&&1===r)this.cancelInternal_(t);else{var u=this.callbackEntries_.splice(o,1)[0];this.executeCallback_(u,i.State_.REJECTED,t)}}},i.prototype.addCallbackEntry_=function(e){this.callbackEntries_&&this.callbackEntries_.length||this.state_!==i.State_.FULFILLED&&this.state_!==i.State_.REJECTED||this.scheduleCallbacks_(),this.callbackEntries_||(this.callbackEntries_=[]),this.callbackEntries_.push(e)},i.prototype.addChildPromise_=function(e,n,r){var o={child:null,onFulfilled:null,onRejected:null};return o.child=new i(function(i,s){o.onFulfilled=e?function(t){try{var n=e.call(r,t);i(n)}catch(o){s(o)}}:i,o.onRejected=n?function(e){try{var o=n.call(r,e);!t.isDef(o)&&e.IS_CANCELLATION_ERROR?s(e):i(o)}catch(a){s(a)}}:s}),o.child.parent_=this,this.addCallbackEntry_(o),o.child},i.prototype.unblockAndFulfill_=function(e){if(this.state_!==i.State_.BLOCKED)throw new Error("CancellablePromise is not blocked.");this.state_=i.State_.PENDING,this.resolve_(i.State_.FULFILLED,e)},i.prototype.unblockAndReject_=function(e){if(this.state_!==i.State_.BLOCKED)throw new Error("CancellablePromise is not blocked.");this.state_=i.State_.PENDING,this.resolve_(i.State_.REJECTED,e)},i.prototype.resolve_=function(e,n){if(this.state_===i.State_.PENDING){if(this===n)e=i.State_.REJECTED,n=new TypeError("CancellablePromise cannot resolve to itself");else{if(r.isImplementedBy(n))return n=n,this.state_=i.State_.BLOCKED,void n.then(this.unblockAndFulfill_,this.unblockAndReject_,this);if(t.isObject(n))try{var o=n.then;if(t.isFunction(o))return void this.tryThen_(n,o)}catch(s){e=i.State_.REJECTED,n=s}}this.result_=n,this.state_=e,this.scheduleCallbacks_(),e!==i.State_.REJECTED||n.IS_CANCELLATION_ERROR||i.addUnhandledRejection_(this,n)}},i.prototype.tryThen_=function(e,t){this.state_=i.State_.BLOCKED;var n=this,r=!1,o=function(e){r||(r=!0,n.unblockAndFulfill_(e))},s=function(e){r||(r=!0,n.unblockAndReject_(e))};try{t.call(e,o,s)}catch(a){s(a)}},i.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,n.run(this.executeCallbacks_,this))},i.prototype.executeCallbacks_=function(){for(;this.callbackEntries_&&this.callbackEntries_.length;){var e=this.callbackEntries_;this.callbackEntries_=[];for(var t=0;t<e.length;t++)this.executeCallback_(e[t],this.state_,this.result_)}this.executing_=!1},i.prototype.executeCallback_=function(e,t,n){t===i.State_.FULFILLED?e.onFulfilled(n):(this.removeUnhandledRejection_(),e.onRejected(n))},i.prototype.removeUnhandledRejection_=function(){var e;if(i.UNHANDLED_REJECTION_DELAY>0)for(e=this;e&&e.unhandledRejectionId_;e=e.parent_)clearTimeout(e.unhandledRejectionId_),e.unhandledRejectionId_=0;else if(0===i.UNHANDLED_REJECTION_DELAY)for(e=this;e&&e.hadUnhandledRejection_;e=e.parent_)e.hadUnhandledRejection_=!1},i.addUnhandledRejection_=function(e,t){i.UNHANDLED_REJECTION_DELAY>0?e.unhandledRejectionId_=setTimeout(function(){i.handleRejection_.call(null,t)},i.UNHANDLED_REJECTION_DELAY):0===i.UNHANDLED_REJECTION_DELAY&&(e.hadUnhandledRejection_=!0,n.run(function(){e.hadUnhandledRejection_&&i.handleRejection_.call(null,t)}))},i.handleRejection_=n.throwException,i.setUnhandledRejectionHandler=function(e){i.handleRejection_=e},i.CancellationError=function(t){function n(t){e.classCallCheck(this,n);var r=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return t&&(r.message=t),r}return e.inherits(n,t),n}(Error),i.CancellationError.prototype.name="cancel",this.wedeployNamed.Promise=this.wedeployNamed.Promise||{},this.wedeployNamed.Promise.CancellablePromise=i,this.wedeploy.Promise=i}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.Uri,r=this.wedeployNamed.Promise.CancellablePromise,o=function(){function o(){e.classCallCheck(this,o)}return e.createClass(o,null,[{key:"parseResponseHeaders",value:function(e){var t=[];if(!e)return t;for(var n=e.split("\r\n"),r=0;r<n.length;r++){var o=n[r].indexOf(": ");if(o>0){var i=n[r].substring(0,o),s=n[r].substring(o+2);t.push({name:i,value:s})}}return t}},{key:"request",value:function i(e,o,s,a,u,c,l,h){e=e||"",o=o||"GET";var i=new XMLHttpRequest,f=new r(function(e,t){i.onload=function(){return i.aborted?void i.onerror():void e(i)},i.onerror=function(){var e=new Error("Request error");e.request=i,t(e)}}).thenCatch(function(e){throw i.abort(),e}).thenAlways(function(){clearTimeout(p)});if(u&&(e=new n(e).addParametersFromMultiMap(u).toString()),i.open(o,e,!l),
h&&(i.withCredentials=!0),a&&a.names().forEach(function(e){i.setRequestHeader(e,a.getAll(e).join(", "))}),i.send(t.isDef(s)?s:null),t.isDefAndNotNull(c))var p=setTimeout(function(){f.cancel("Request timeout")},c);return f}}]),o}();this.wedeploy.Ajax=o}.call(this),function(){var t=this.wedeploy.Ajax,n=this.wedeploy.Transport,r=this.wedeploy.ClientResponse,o=function(n){function o(){return e.classCallCheck(this,o),e.possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return e.inherits(o,n),e.createClass(o,[{key:"send",value:function(e){var n=t.request(e.url(),e.method(),e.body(),e.headers(),e.params(),null,!1,e.withCredentials());return n.then(function(n){var o=new r(e);return o.body(n.responseText),o.statusCode(n.status),o.statusText(n.statusText),t.parseResponseHeaders(n.getAllResponseHeaders()).forEach(function(e){o.header(e.name,e.value)}),o})}}]),o}(n);this.wedeploy.AjaxTransport=o}.call(this),function(){var t=this.wedeploy.AjaxTransport,n=function(){function t(){e.classCallCheck(this,t),this.transports={},this.transports[t.DEFAULT_TRANSPORT_NAME]=t[t.DEFAULT_TRANSPORT_NAME]}return e.createClass(t,[{key:"get",value:function(e){var t=this.transports[e];if(!t)throw new Error("Invalid transport name: "+e);try{return new t}catch(n){throw new Error("Can't create transport",n)}}},{key:"getDefault",value:function(){return this.get(t.DEFAULT_TRANSPORT_NAME)}}],[{key:"instance",value:function(){return t.instance_||(t.instance_=new t),t.instance_}}]),t}();n.DEFAULT_TRANSPORT_NAME="default",n[n.DEFAULT_TRANSPORT_NAME]=t,this.wedeploy.TransportFactory=n}.call(this),function(){var e={};"undefined"!=typeof window&&(e.window=window),"undefined"!=typeof document&&(e.document=document),this.wedeploy.globals=e}.call(this),function(){function e(){if(!c.window)throw new Error("Sign-in type not supported in this environment")}function t(e,t){if(!u.isDefAndNotNull(e))throw new Error(t)}function n(e,t){if(u.isNull(e))throw new Error(t)}function r(e,t){if(!u.isFunction(e))throw new Error(t)}function o(e,t){if(!u.isObject(e))throw new Error(t)}function i(e){if(!e.succeeded())throw e.body();return e}function s(e){if(!u.isDefAndNotNull(e))throw new Error("You must be signed-in to perform this operation")}function a(e,t){var n=new l(e);if(n.getPathname().length>1)throw new Error(t)}var u=this.wedeployNamed.metal.core,c=this.wedeploy.globals,l=this.wedeploy.Uri;this.wedeployNamed.assertions=this.wedeployNamed.assertions||{},this.wedeployNamed.assertions.assertBrowserEnvironment=e,this.wedeployNamed.assertions.assertDefAndNotNull=t,this.wedeployNamed.assertions.assertNotNull=n,this.wedeployNamed.assertions.assertFunction=r,this.wedeployNamed.assertions.assertObject=o,this.wedeployNamed.assertions.assertResponseSucceeded=i,this.wedeployNamed.assertions.assertUserSignedIn=s,this.wedeployNamed.assertions.assertUriWithNoPath=a}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeployNamed.assertions.assertDefAndNotNull,r=this.wedeployNamed.assertions.assertObject,o=this.wedeployNamed.assertions.assertResponseSucceeded,i=function(){function i(n){var r=arguments.length<=1||void 0===arguments[1]?null:arguments[1];e.classCallCheck(this,i),this.token=t.isString(r)?null:n,this.email=t.isString(r)?n:null,this.password=r,this.createdAt=null,this.id=null,this.name=null,this.photoUrl=null,this.wedeployClient=null}return e.createClass(i,[{key:"getCreatedAt",value:function(){return this.createdAt}},{key:"getEmail",value:function(){return this.email}},{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getPassword",value:function(){return this.password}},{key:"getPhotoUrl",value:function(){return this.photoUrl}},{key:"getToken",value:function(){return this.token}},{key:"hasCreatedAt",value:function(){return t.isDefAndNotNull(this.createdAt)}},{key:"hasEmail",value:function(){return t.isDefAndNotNull(this.email)}},{key:"hasId",value:function(){return t.isDefAndNotNull(this.id)}},{key:"hasName",value:function(){return t.isDefAndNotNull(this.name)}},{key:"hasPassword",value:function(){return t.isDefAndNotNull(this.password)}},{key:"hasPhotoUrl",value:function(){return t.isDefAndNotNull(this.photoUrl)}},{key:"hasToken",value:function(){return t.isDefAndNotNull(this.token)}},{key:"setCreatedAt",value:function(e){this.createdAt=e}},{key:"setEmail",value:function(e){this.email=e}},{key:"setId",value:function(e){this.id=e}},{key:"setName",value:function(e){this.name=e}},{key:"setPassword",value:function(e){this.password=e}},{key:"setPhotoUrl",value:function(e){this.photoUrl=e}},{key:"setToken",value:function(e){this.token=e}},{key:"setWedeployClient",value:function(e){this.wedeployClient=e}},{key:"updateUser",value:function(e){return r(e,"User data must be specified as object"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/users").auth(this).patch(e).then(function(e){return o(e)})}},{key:"deleteUser",value:function(){return n(this.id,"Cannot delete user without id"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/users",this.id).auth(this)["delete"]().then(function(e){return o(e)})}}],[{key:"create",value:function(e,t){return new i(e,t)}}]),i}();this.wedeploy.Auth=i}.call(this),function(){function t(e,t){if(n.isDefAndNotNull(e)&&!n.isString(e))throw new Error(t)}var n=this.wedeployNamed.metal.core,r=this.wedeploy.Uri,o=function(){function o(){e.classCallCheck(this,o),this.provider=null,this.providerScope=null,this.redirectUri=null,this.scope=null}return e.createClass(o,[{key:"hasProvider",value:function(){return n.isDefAndNotNull(this.provider)}},{key:"hasProviderScope",value:function(){return n.isDefAndNotNull(this.providerScope)}},{key:"hasRedirectUri",value:function(){return n.isDefAndNotNull(this.redirectUri)}},{key:"hasScope",value:function(){return n.isDefAndNotNull(this.scope)}},{key:"makeAuthorizationUrl",value:function(e){var t=new r(e);return t.setPathname("/oauth/authorize"),this.hasProvider()&&t.setParameterValue("provider",this.getProvider()),this.hasProviderScope()&&t.setParameterValue("provider_scope",this.getProviderScope()),this.hasRedirectUri()&&t.setParameterValue("redirect_uri",this.getRedirectUri()),this.hasScope()&&t.setParameterValue("scope",this.getScope()),t.toString()}},{key:"getProvider",value:function(){return this.provider}},{key:"getProviderScope",value:function(){return this.providerScope}},{key:"getRedirectUri",value:function(){return this.redirectUri}},{key:"getScope",value:function(){return this.scope}},{key:"setProviderScope",value:function(e){t(e,"Provider scope must be a string"),this.providerScope=e}},{key:"setRedirectUri",value:function(e){t(e,"Redirect uri must be a string"),this.redirectUri=e}},{key:"setScope",value:function(e){t(e,"Scope must be a string"),this.scope=e}}]),o}();this.wedeploy.AuthProvider=o}.call(this),function(){var t=this.wedeploy.AuthProvider,n=function(t){function n(){e.classCallCheck(this,n);var t=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.provider=n.PROVIDER,t}return e.inherits(n,t),n}(t);n.PROVIDER="facebook",this.wedeploy.FacebookAuthProvider=n}.call(this),function(){var t=this.wedeploy.AuthProvider,n=function(t){function n(){e.classCallCheck(this,n);var t=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.provider=n.PROVIDER,t}return e.inherits(n,t),n}(t);n.PROVIDER="github",this.wedeploy.GithubAuthProvider=n}.call(this),function(){var t=this.wedeploy.AuthProvider,n=function(t){function n(){e.classCallCheck(this,n);var t=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.provider=n.PROVIDER,t}return e.inherits(n,t),n}(t);n.PROVIDER="google",this.wedeploy.GoogleAuthProvider=n}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,[{key:"clear",value:function(){throw Error("Unimplemented abstract method")}},{key:"set",value:function(e,t){throw Error("Unimplemented abstract method")}},{key:"get",value:function(e){throw Error("Unimplemented abstract method")}},{key:"keys",value:function(){throw Error("Unimplemented abstract method")}},{key:"remove",value:function(e){throw Error("Unimplemented abstract method")}},{key:"size",value:function(){throw Error("Unimplemented abstract method")}}]),t}();this.wedeploy.StorageMechanism=t}.call(this),function(){function t(e){if(!r.isDefAndNotNull(e))throw Error("Storage mechanism is required")}function n(e){if(!(e instanceof o))throw Error("Storage mechanism must me an implementation of StorageMechanism")}var r=this.wedeploy.metal,o=this.wedeploy.StorageMechanism,i=function(){function o(r){e.classCallCheck(this,o),t(r),n(r),this.mechanism=r}return e.createClass(o,[{key:"clear",value:function(){this.mechanism.clear()}},{key:"set",value:function(e,t){return r.isDef(t)?void this.mechanism.set(e,JSON.stringify(t)):void this.mechanism.remove(e)}},{key:"get",value:function(e){var t;try{t=this.mechanism.get(e)}catch(n){return}if(!r.isNull(t))try{return JSON.parse(t)}catch(n){throw o.ErrorCode.INVALID_VALUE}}},{key:"keys",value:function(){return this.mechanism.keys()}},{key:"remove",value:function(e){this.mechanism.remove(e)}},{key:"size",value:function(){return this.mechanism.size()}},{key:"values",value:function(){var e=this;return this.keys().map(function(t){return e.get(t)})}}]),o}();i.ErrorCode={INVALID_VALUE:"Storage: Invalid value was encountered"},this.wedeploy.Storage=i}.call(this),function(){var t=this.wedeploy.StorageMechanism,n=function(t){function n(){return e.classCallCheck(this,n),e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return e.inherits(n,t),e.createClass(n,[{key:"storage",value:function(){return n.globals.localStorage}},{key:"clear",value:function(){this.storage().clear()}},{key:"keys",value:function(){return Object.keys(this.storage())}},{key:"get",value:function(e){return this.storage().getItem(e)}},{key:"remove",value:function(e){this.storage().removeItem(e)}},{key:"set",value:function(e,t){this.storage().setItem(e,t)}},{key:"size",value:function(){return this.storage().length}}]),n}(t);n.globals={localStorage:window.localStorage},this.wedeploy.LocalStorageMechanism=n}.call(this),function(){var e=this.wedeploy.Storage,t=this.wedeploy.StorageMechanism,n=this.wedeploy.LocalStorageMechanism;this.wedeployNamed.storage=this.wedeployNamed.storage||{},this.wedeployNamed.storage.Storage=e,this.wedeployNamed.storage.StorageMechanism=t,this.wedeployNamed.storage.LocalStorageMechanism=n}.call(this),function(){function t(e){switch(e.constructor.PROVIDER){case r.PROVIDER:case o.PROVIDER:case s.PROVIDER:break;default:throw new Error("Sign-in provider not supported")}}var n=this.wedeploy.Auth,r=this.wedeploy.FacebookAuthProvider,o=this.wedeploy.GithubAuthProvider,i=this.wedeploy.globals,s=this.wedeploy.GoogleAuthProvider,a=this.wedeployNamed.storage.Storage,u=this.wedeployNamed.storage.LocalStorageMechanism,c=this.wedeployNamed.assertions.assertDefAndNotNull,l=this.wedeployNamed.assertions.assertFunction,h=this.wedeployNamed.assertions.assertObject,f=this.wedeployNamed.assertions.assertUserSignedIn,p=this.wedeployNamed.assertions.assertBrowserEnvironment,d=this.wedeployNamed.assertions.assertResponseSucceeded,y=function(){function y(t){e.classCallCheck(this,y),c(t,"WeDeploy client reference must be specified"),this.currentUser=null,this.onSignInCallback=null,this.onSignOutCallback=null,this.wedeployClient=t,this.storage=new a(new u),this.processSignIn_(),this.provider={Facebook:r,Google:s,Github:o}}return e.createClass(y,[{key:"createUser",value:function(e){var t=this;return h(e,"User data must be specified as object"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/users").post(e).then(function(e){return d(e)}).then(function(e){return t.makeUserAuthFromData(e.body())})}},{key:"getHrefWithoutFragment_",value:function(){var e=i.window.location;return e.protocol+"//"+e.host+e.pathname+(e.search?e.search:"")}},{key:"getRedirectAccessToken_",value:function(){if(i.window){var e=i.window.location.hash;if(0===e.indexOf("#access_token="))return e.substring(14)}return null}},{key:"getUser",value:function(e){return c(e,"User userId must be specified"),f(this.currentUser),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/users",e).auth(this.currentUser.token).get().then(function(e){return d(e)})}},{key:"loadCurrentUser",value:function(e){var t=this;return c(e,"User token must be specified"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/user").auth(e).get().then(function(n){var r=n.body();return r.token=e,t.currentUser=t.makeUserAuthFromData(r),t.storage.set("currentUser",r),t.currentUser})}},{key:"makeUserAuthFromData",value:function(e){var t=new n;return t.setWedeployClient(this.wedeployClient),t.setCreatedAt(e.createdAt),t.setEmail(e.email),t.setId(e.id),t.setName(e.name),t.setPhotoUrl(e.photoUrl),t.setToken(e.token),t}},{key:"maybeCallOnSignInCallback_",value:function(){this.onSignInCallback&&this.onSignInCallback.call(this,this.currentUser)}},{key:"maybeCallOnSignOutCallback_",value:function(){this.onSignOutCallback&&this.onSignOutCallback.call(this,this.currentUser)}},{key:"onSignIn",value:function(e){l(e,"Sign-in callback must be a function"),this.onSignInCallback=e}},{key:"onSignOut",value:function(e){l(e,"Sign-out callback must be a function"),this.onSignOutCallback=e}},{key:"processSignIn_",value:function(){var e=this,t=this.getRedirectAccessToken_();if(t)return this.removeUrlFragmentCompletely_(),void this.loadCurrentUser(t).then(function(){return e.maybeCallOnSignInCallback_()});var n=this.storage.get("currentUser");n&&(this.currentUser=this.makeUserAuthFromData(n))}},{key:"removeUrlFragmentCompletely_",value:function(){i.window.history.pushState({},document.title,window.location.pathname+window.location.search)}},{key:"sendPasswordResetEmail",value:function(e){return c(e,"Send password reset email must be specified"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/user/recover").param("email",e).post().then(function(e){return d(e)})}},{key:"signInWithEmailAndPassword",value:function(e,t){var n=this;return c(e,"Sign-in email must be specified"),c(t,"Sign-in password must be specified"),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/oauth/token").param("grant_type","password").param("username",e).param("password",t).get().then(function(e){return d(e)}).then(function(e){return n.loadCurrentUser(e.body().access_token)}).then(function(e){return n.maybeCallOnSignInCallback_(),e})}},{key:"signInWithRedirect",value:function(e){p(),c(e,"Sign-in provider must be defined"),t(e),e.hasRedirectUri()||e.setRedirectUri(this.getHrefWithoutFragment_()),i.window.location.href=e.makeAuthorizationUrl(this.wedeployClient.authUrl_)}},{key:"signOut",value:function(){var e=this;return f(this.currentUser),this.wedeployClient.url(this.wedeployClient.authUrl_).path("/oauth/revoke").param("token",this.currentUser.token).get().then(function(e){return d(e)}).then(function(t){return e.maybeCallOnSignOutCallback_(),e.unloadCurrentUser_(),t})}},{key:"unloadCurrentUser_",value:function(){this.currentUser=null,this.storage.remove("currentUser")}}]),y}();this.wedeploy.AuthApiHelper=y}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t),this.body_={}}return e.createClass(t,[{key:"body",value:function(){return this.body_}},{key:"toString",value:function(){return JSON.stringify(this.body())}}],[{key:"toBody",value:function(e){return e instanceof t?e.body():e}}]),t}();this.wedeploy.Embodied=t}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.Embodied,r=function(){function r(o,i,s){e.classCallCheck(this,r);var a={operator:t.isDef(s)?i:"="},u=t.isDef(s)?s:i;t.isDefAndNotNull(u)&&(u instanceof n&&(u=u.body()),a.value=u),t.isDefAndNotNull(o)?this.createBody_(o,a):this.createBody_("and",[])}return e.createClass(r,[{key:"add",value:function(e,t){t?this.addArrayOperator_(e,t):this.createBody_(e,this.body_)}},{key:"addArrayOperator_",value:function(e,t){this.body_[e]instanceof Array||this.createBody_(e,[this.body_]),this.body_[e].push(t.body())}},{key:"addMany",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0;o<n.length;o++)this.add(e,n[o])}},{key:"createBody_",value:function(e,t){this.body_={},this.body_[e]=t}},{key:"getObject",value:function(){return this.body_}}]),r}();this.wedeploy.FilterBody=r}.call(this),function(){var t=this.wedeploy.Embodied,n=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,null,[{key:"boundingBox",value:function(e,n){return new t.BoundingBox(e,n)}},{key:"circle",value:function(e,n){return new t.Circle(e,n)}},{key:"line",value:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return new(Function.prototype.bind.apply(t.Line,[null].concat(n)))}},{key:"point",value:function(e,n){return new t.Point(e,n)}},{key:"polygon",value:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return new(Function.prototype.bind.apply(t.Polygon,[null].concat(n)))}}]),t}(),r=function(t){function n(t,r){e.classCallCheck(this,n);var o=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return o.body_=[t,r],o}return e.inherits(n,t),n}(t);n.Point=r;var o=function(n){function r(){e.classCallCheck(this,r);for(var n=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n.body_={type:"linestring",coordinates:i.map(function(e){return t.toBody(e)})},n}return e.inherits(r,n),r}(t);n.Line=o;var i=function(n){function r(n,o){e.classCallCheck(this,r);var i=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return i.body_={type:"envelope",coordinates:[t.toBody(n),t.toBody(o)]},i}return e.inherits(r,n),e.createClass(r,[{key:"getPoints",value:function(){return this.body_.coordinates}}]),r}(t);n.BoundingBox=i;var s=function(n){function r(n,o){e.classCallCheck(this,r);var i=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return i.body_={type:"circle",coordinates:t.toBody(n),radius:o},i}return e.inherits(r,n),e.createClass(r,[{key:"getCenter",value:function(){return this.body_.coordinates}},{key:"getRadius",value:function(){return this.body_.radius}}]),r}(t);n.Circle=s;var a=function(n){function r(){e.classCallCheck(this,r);var t=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.body_={type:"polygon",coordinates:[]},t.addCoordinates_.apply(t,arguments),t}return e.inherits(r,n),e.createClass(r,[{key:"addCoordinates_",value:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];this.body_.coordinates.push(n.map(function(e){return t.toBody(e)}))}},{key:"hole",value:function(){return this.addCoordinates_.apply(this,arguments),this}}]),r}(t);n.Polygon=a,this.wedeploy.Geo=n}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.Embodied,r=function(n){function r(n,o){e.classCallCheck(this,r);var i=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.isDefAndNotNull(n)&&(i.body_.from=n),t.isDefAndNotNull(o)&&(i.body_.to=o),i}return e.inherits(r,n),e.createClass(r,null,[{key:"from",value:function(e){return new r(e)}},{key:"range",value:function(e,t){return new r(e,t)}},{key:"to",value:function(e){return new r(null,e)}}]),r}(n);this.wedeploy.Range=r}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.Embodied,r=this.wedeploy.FilterBody,o=this.wedeploy.Geo,i=this.wedeploy.Range,s=function(s){function a(t,n,o){e.classCallCheck(this,a);var i=e.possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return i.body_=new r(t,n,o),i}return e.inherits(a,s),e.createClass(a,[{key:"add",value:function(e,t,n,r){var o=t?a.toFilter(t,n,r):null;return this.body_.add(e,o),this}},{key:"addMany",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.body_).addMany.apply(t,[e].concat(r)),this}},{key:"and",value:function(e,t,n){return this.add("and",e,t,n)}},{key:"body",value:function(){return this.body_.getObject()}},{key:"or",value:function(e,t,n){return this.add("or",e,t,n)}}],[{key:"any",value:function(e){var t=Array.prototype.slice.call(arguments,1);return 1===t.length&&t[0]instanceof Array&&(t=t[0]),new a(e,"any",t)}},{key:"boundingBox",value:function(t,n,r){return n instanceof o.BoundingBox?a.polygon.apply(a,[t].concat(e.toConsumableArray(n.getPoints()))):a.polygon(t,n,r)}},{key:"distance",value:function(e,t,n){var r=t,s=n;return t instanceof o.Circle?(r=t.getCenter(),s=i.to(t.getRadius())):n instanceof i||(s=i.to(n)),a.distanceInternal_(e,r,s)}},{key:"distanceInternal_",value:function(e,t,r){var o={location:n.toBody(t)};return r=r.body(),r.from&&(o.min=r.from),r.to&&(o.max=r.to),a.field(e,"gd",o)}},{key:"equal",value:function(e,t){return new a(e,"=",t)}},{key:"exists",value:function(e){return a.field(e,"exists",null)}},{key:"fuzzy",value:function(e,t,n){return a.fuzzyInternal_("fuzzy",e,t,n)}},{key:"fuzzyInternal_",value:function(e,n,r,o){var i=t.isString(r),s={query:i?r:n},u=i?o:r;u&&(s.fuzziness=u);var c=i?n:a.ALL;return a.field(c,e,s)}},{key:"gt",value:function(e,t){return new a(e,">",t)}},{key:"gte",value:function(e,t){return new a(e,">=",t)}},{key:"match",value:function(e,n){var r=t.isString(n)?e:a.ALL,o=t.isString(n)?n:e;return a.field(r,"match",o)}},{key:"missing",value:function(e){return a.field(e,"missing",null)}},{key:"phrase",value:function(e,n){var r=t.isString(n)?e:a.ALL,o=t.isString(n)?n:e;return a.field(r,"phrase",o)}},{key:"polygon",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r=r.map(function(e){return n.toBody(e)}),a.field(e,"gp",r)}},{key:"prefix",value:function(e,t){var n=t?e:a.ALL,r=t?t:e;return a.field(n,"prefix",r)}},{key:"range",value:function u(e,t,n){var u=t;return u instanceof i||(u=i.range(t,n)),a.field(e,"range",u)}},{key:"regex",value:function(e,t){return new a(e,"~",t)}},{key:"shape",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];r=r.map(function(e){return n.toBody(e)});var i={type:"geometrycollection",geometries:r};return a.field(e,"gs",i)}},{key:"similar",value:function(e,n){var r=t.isString(n)?e:a.ALL,o={query:t.isString(n)?n:e};return a.field(r,"similar",o)}},{key:"lt",value:function(e,t){return new a(e,"<",t)}},{key:"lte",value:function(e,t){return new a(e,"<=",t)}},{key:"none",value:function(e){var t=Array.prototype.slice.call(arguments,1);return 1===t.length&&t[0]instanceof Array&&(t=t[0]),new a(e,"none",t)}},{key:"notEqual",value:function(e,t){return new a(e,"!=",t)}},{key:"not",value:function(e,t,n){return a.toFilter(e,t,n).add("not")}},{key:"field",value:function(e,t,n){return new a(e,t,n)}},{key:"toFilter",value:function(e,t,n){var r=e;return r instanceof a||(r=a.field(e,t,n)),r}}]),a}(n);s.ALL="*",this.wedeploy.Filter=s}.call(this),function(){var t=this.wedeploy.Embodied,n=this.wedeploy.Range,r=function(){function t(n,r,o){e.classCallCheck(this,t),this.field_=n,this.operator_=r,this.value_=o}return e.createClass(t,[{key:"getField",value:function(){return this.field_}},{key:"getOperator",value:function(){return this.operator_}},{key:"getValue",value:function(){return this.value_}}],[{key:"avg",value:function(e){return t.field(e,"avg")}},{key:"count",value:function(e){return t.field(e,"count")}},{key:"distance",value:function(e,n){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return new(Function.prototype.bind.apply(t.DistanceAggregation,[null].concat([e,n],o)))}},{key:"extendedStats",value:function(e){return t.field(e,"extendedStats")}},{key:"histogram",value:function(e,n){return new t(e,"histogram",n)}},{key:"max",value:function(e){return t.field(e,"max")}},{key:"min",value:function(e){return t.field(e,"min")}},{key:"missing",value:function(e){return t.field(e,"missing")}},{key:"field",value:function(e,n){return new t(e,n)}},{key:"range",value:function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return new(Function.prototype.bind.apply(t.RangeAggregation,[null].concat([e],r)))}},{key:"stats",value:function(e){return t.field(e,"stats")}},{key:"sum",value:function(e){return t.field(e,"sum")}},{key:"terms",value:function(e){return t.field(e,"terms")}}]),t}(),o=function(r){function o(n,r){e.classCallCheck(this,o);var i=e.possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,n,"geoDistance",{}));i.value_.location=t.toBody(r);for(var s=arguments.length,a=Array(s>2?s-2:0),u=2;u<s;u++)a[u-2]=arguments[u];return i.value_.ranges=a.map(function(e){return e.body()}),i}return e.inherits(o,r),e.createClass(o,[{key:"range",value:function i(e,t){var i=e;return i instanceof n||(i=n.range(e,t)),this.value_.ranges.push(i.body()),this}},{key:"unit",value:function(e){return this.value_.unit=e,this}}]),o}(r);r.DistanceAggregation=o;var i=function(t){function r(t){e.classCallCheck(this,r);for(var n=e.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,"range")),o=arguments.length,i=Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];return n.value_=i.map(function(e){return e.body()}),n}return e.inherits(r,t),e.createClass(r,[{key:"range",value:function o(e,t){var o=e;return o instanceof n||(o=n.range(e,t)),this.value_.push(o.body()),this}}]),r}(r);r.RangeAggregation=i,this.wedeploy.Aggregation=r}.call(this),function(){var t=this.wedeployNamed.metal.core,n=this.wedeploy.Embodied,r=this.wedeploy.Filter,o=this.wedeploy.Aggregation,i=function(n){function i(){return e.classCallCheck(this,i),e.possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return e.inherits(i,n),e.createClass(i,[{key:"aggregate",value:function(e,n,r){var i=n;i instanceof o||(i=o.field(n,r));var s=i.getField(),a={};return a[s]={name:e,operator:i.getOperator()},t.isDefAndNotNull(i.getValue())&&(a[s].value=i.getValue()),this.body_.aggregation||(this.body_.aggregation=[]),this.body_.aggregation.push(a),this}},{key:"count",value:function(){return this.type("count")}},{key:"fetch",value:function(){return this.type("fetch")}},{key:"filter",value:function s(e,t,n){var s=r.toFilter(e,t,n);return this.body_.filter||(this.body_.filter=[]),this.body_.filter.push(s.body()),this}},{key:"offset",value:function(e){return this.body_.offset=e,this}},{key:"highlight",value:function(e){return this.body_.highlight||(this.body_.highlight=[]),this.body_.highlight.push(e),this}},{key:"limit",value:function(e){return this.body_.limit=e,this}},{key:"search",value:function(e,t,n){var o=e;return n?o=r.field(e,t,n):t?o=r.match(e,t):o instanceof r||(o=r.match(e)),this.body_.search||(this.body_.search=[]),this.body_.search.push(o.body()),this}},{key:"sort",value:function(e,t){this.body_.sort||(this.body_.sort=[]);var n={};return n[e]=t||"asc",this.body_.sort.push(n),this}},{key:"type",value:function(e){return this.body_.type=e,this}}],[{key:"aggregate",value:function(e,t,n){return(new i).aggregate(e,t,n)}},{key:"count",value:function(){return(new i).type("count")}},{key:"fetch",value:function(){return(new i).type("fetch")}},{key:"filter",value:function(e,t,n){return(new i).filter(e,t,n)}},{key:"offset",value:function(e){return(new i).offset(e)}},{key:"highlight",value:function(e){return(new i).highlight(e)}},{key:"limit",value:function(e){return(new i).limit(e)}},{key:"search",value:function(e,t,n){return(new i).search(e,t,n)}},{key:"sort",value:function(e,t){return(new i).sort(e,t)}},{key:"type",value:function(e){return(new i).type(e)}}]),i}(n);this.wedeploy.Query=i}.call(this),function(){var t=this.wedeploy.Query,n=this.wedeploy.Filter,r=this.wedeployNamed.assertions.assertNotNull,o=this.wedeployNamed.assertions.assertObject,i=this.wedeployNamed.assertions.assertDefAndNotNull,s=this.wedeployNamed.assertions.assertResponseSucceeded,a=this.wedeployNamed.metal.core,u=function(){function u(t){e.classCallCheck(this,u),i(t,"WeDeploy client reference must be specified"),this.wedeployClient=t}return e.createClass(u,[{key:"onSearch",value:function(){return this.getOrCreateQuery_().search(this.getOrCreateFilter_()),this.onSearch_=!0,this}},{key:"where",value:function(e,t,n){return this.getOrCreateFilter_().and(e,t,n),this}},{key:"or",value:function(e,t,n){if(this.getOrCreateFilter_().body().and.length<=0)throw Error("It's required to have a condition before using an 'or()' for the first time.");return this.getOrCreateFilter_().or(e,t,n),this}},{key:"none",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.where(n.none(e,r))}},{key:"match",value:function(e,t){return this.where(n.match(e,t))}},{key:"similar",value:function(e,t){return this.where(n.similar(e,t))}},{key:"lt",value:function(e,t){return this.where(n.lt(e,t))}},{key:"lte",value:function(e,t){return this.where(n.lte(e,t))}},{key:"any",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.where(n.any(e,r))}},{key:"boundingBox",value:function(e,t,r){return this.where(n.boundingBox(e,t,r))}},{key:"distance",value:function(e,t,r){return this.where(n.distance(e,t,r))}},{key:"range",value:function(e,t,r){return this.where(n.range(e,t,r))}},{key:"limit",value:function(e){return this.getOrCreateQuery_().limit(e),this}},{key:"offset",value:function(e){return this.getOrCreateQuery_().offset(e),this}},{key:"highlight",value:function(e){return this.getOrCreateQuery_().highlight(e),this}},{key:"aggregate",value:function(e,t,n){return this.getOrCreateQuery_().aggregate(e,t,n),this}},{key:"count",value:function(){return this.getOrCreateQuery_().type("count"),this}},{key:"orderBy",value:function(e,t){return this.getOrCreateQuery_().sort(e,t),this}},{key:"create",value:function(e,t){return r(e,"Collection key must be specified."),o(t,"Data can't be empty."),this.wedeployClient.url(this.wedeployClient.dataUrl_).path(e).post(t).then(function(e){return s(e)}).then(function(e){return e.body()})}},{key:"update",value:function(e,t){return r(e,"Document key must be specified."),o(t,"Data must be specified."),this.wedeployClient.url(this.wedeployClient.dataUrl_).path(e).put(t).then(function(e){return s(e)}).then(function(e){return e.body()})}},{key:"delete",value:function(e){return r(e,"Document/Field/Collection key must be specified"),this.wedeployClient.url(this.wedeployClient.dataUrl_).path(e)["delete"]().then(function(e){return s(e)}).then(function(e){})}},{key:"get",value:function(e){return r(e,"Document/Field/Collection key must be specified"),this.addFiltersToQuery_(),this.wedeployClient.url(this.wedeployClient.dataUrl_).path(e).get(this.query_).then(function(e){return s(e)}).then(function(e){return e.body()})}},{key:"watch",value:function(e,t){return r(e,"Collection key must be specified"),this.addFiltersToQuery_(),this.wedeployClient.url(this.wedeployClient.dataUrl_).path(e).watch(this.query_,t)}},{key:"getOrCreateFilter_",value:function(){return this.filter_||(this.filter_=new n),this.filter_}},{key:"getOrCreateQuery_",value:function(){return this.query_||(this.query_=new t),this.query_}},{key:"addFiltersToQuery_",value:function(){return a.isDef(this.filter_)&&1!=this.onSearch_&&this.getOrCreateQuery_().filter(this.filter_),this}}]),u}();this.wedeploy.DataApiHelper=u}.call(this),function(){var t=function(){function t(){e.classCallCheck(this,t)}return e.createClass(t,null,[{key:"encodeString",value:function(e){return"function"==typeof btoa?btoa(e):new Buffer(e.toString(),"binary")}}]),t}();this.wedeploy.Base64=t}.call(this),function(){var t,n=this.wedeploy.globals,r=this.wedeployNamed.metal.core,o=this.wedeploy.Auth,i=this.wedeploy.AuthApiHelper,s=this.wedeploy.DataApiHelper,a=this.wedeploy.Base64,u=this.wedeploy.Embodied,c=this.wedeploy.Query,l=this.wedeploy.Filter,h=this.wedeploy.TransportFactory,f=this.wedeploy.ClientRequest,p=this.wedeployNamed.structs.MultiMap,d=this.wedeploy.Uri,y=this.wedeployNamed.assertions.assertUriWithNoPath;
"undefined"!=typeof n.window&&(t=n.window.io);var v=function(){function n(t){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];if(e.classCallCheck(this,n),0===arguments.length)throw new Error("Invalid arguments, try `new WeDeploy(baseUrl, url)`");this.auth_=null,this.body_=null,this.url_=d.joinPaths.apply(d,[t||""].concat(o)),this.headers_=new p,this.params_=new p,this.withCredentials_=!0,this.header("Content-Type","application/json"),this.header("X-Requested-With","XMLHttpRequest")}return e.createClass(n,[{key:"auth",value:function(e,t){return this.auth_=e,this.auth_ instanceof o||(this.auth_=o.create(e,t)),this}},{key:"body",value:function(e){return this.body_=e,this}},{key:"convertBodyToParams_",value:function(e,t){r.isString(t)?t={body:t}:t instanceof u&&(t=t.body()),Object.keys(t||{}).forEach(function(n){return e.param(n,t[n])})}},{key:"createClientRequest_",value:function(e,t){var n=new f;return n.body(t||this.body_),r.isDefAndNotNull(n.body())||this.formData_&&n.body(this.formData_),n.method(e),n.headers(this.headers()),n.params(this.params()),n.url(this.url()),n.withCredentials(this.withCredentials_),this.encode(n),n}},{key:"decode",value:function(e){if(n.isContentTypeJson(e))try{e.body(JSON.parse(e.body()))}catch(t){}return e}},{key:"delete",value:function(e){return this.sendAsync("DELETE",e)}},{key:"encode",value:function(e){var t=e.body();return r.isElement(t)&&(t=new FormData(t),e.body(t)),t=this.maybeWrapWithQuery_(t),"GET"===e.method()&&(this.convertBodyToParams_(e,t),e.removeBody(),t=null),"undefined"!=typeof FormData&&t instanceof FormData?e.headers().remove("content-type"):t instanceof u?e.body(t.toString()):n.isContentTypeJson(e)&&e.body(JSON.stringify(e.body())),this.encodeParams_(e),this.resolveAuthentication_(e),e}},{key:"encodeParams_",value:function(e){var t=e.params();t.names().forEach(function(e){var n=t.getAll(e);n.forEach(function(e,t){e instanceof u?e=e.toString():(r.isObject(e)||e instanceof Array)&&(e=JSON.stringify(e)),n[t]=e})})}},{key:"form",value:function(e,t){if("undefined"==typeof FormData)throw new Error("form() is only available when FormData API is available.");return this.formData_||(this.formData_=new FormData),this.formData_.append(e,t),this}},{key:"get",value:function(e){return this.sendAsync("GET",e)}},{key:"header",value:function(e,t){if(2!==arguments.length)throw new Error("Invalid arguments");return this.headers_.set(e,t),this}},{key:"headers",value:function(){return this.headers_}},{key:"maybeWrapWithQuery_",value:function(e){return e instanceof l&&(e=c.filter(e)),e}},{key:"param",value:function(e,t){if(2!==arguments.length)throw new Error("Invalid arguments");return this.params_.set(e,t),this}},{key:"params",value:function(){return this.params_}},{key:"patch",value:function(e){return this.sendAsync("PATCH",e)}},{key:"path",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(new(Function.prototype.bind.apply(n,[null].concat([this.url()],t)))).use(this.customTransport_)}},{key:"post",value:function(e){return this.sendAsync("POST",e)}},{key:"put",value:function(e){return this.sendAsync("PUT",e)}},{key:"resolveAuthentication_",value:function(e){if(this.auth_)if(this.auth_.hasToken())e.header("Authorization","Bearer "+this.auth_.token);else{var t=this.auth_.email+":"+this.auth_.password;e.header("Authorization","Basic "+a.encodeString(t))}}},{key:"sendAsync",value:function(e,t){var n=this.customTransport_||h.instance().getDefault(),r=this.createClientRequest_(e,t);return n.send(r).then(this.decode)}},{key:"url",value:function(){return this.url_}},{key:"use",value:function(e){return this.customTransport_=e,this}},{key:"watch",value:function(e,n){if("undefined"==typeof t)throw new Error("Socket.io client not loaded");var r=this.createClientRequest_("GET",e),o=new d(r.url());return o.addParametersFromMultiMap(r.params()),n=n||{forceNew:!0},n.query="url="+encodeURIComponent(o.getPathname()+o.getSearch()),n.path=n.path||o.getPathname(),t(o.getHost(),n)}}],[{key:"data",value:function(e){return y(e,"The data url should not have a path"),r.isString(e)&&(n.dataUrl_=e),n.data_||(n.data_=new s(n)),n.data_}},{key:"auth",value:function(e){return r.isString(e)&&(n.authUrl_=e),n.auth_||(n.auth_=new i(n)),n.auth_}},{key:"socket",value:function(e){t=e}},{key:"url",value:function(e){return new n(e).use(this.customTransport_)}}]),n}();v.isContentTypeJson=function(e){var t=e.headers().get("content-type")||"";return 0===t.indexOf("application/json")},v.auth_=null,v.authUrl_="",v.data_=null,v.dataUrl_="",this.wedeploy.WeDeploy=v}.call(this),function(){var e=this.wedeploy.globals,t=this.wedeploy.Filter,n=this.wedeploy.Geo,r=this.wedeploy.WeDeploy,o=this.wedeploy.Query,i=this.wedeploy.Range;e.window.Filter=t,e.window.Geo=n,e.window.Query=o,e.window.Range=i,e.window.WeDeploy=r}.call(this)}.call(this);